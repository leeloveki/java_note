网络三要素: IP地址 端口 协议

> 注意端口是和协议相配对的
>
> TCP协议和UDP协议的端口相互独立, 互不影响

常见程序的端口:

tomcat 8080 nginx  80 mysql 3306 redis 6379 ftp使用20和21

如何查看服务器上使用中的端口

```bash
netstat -ano 
netstat -tulpn
```

>xml中只能有双标签元素

> 但是在html中允许有单标签元素 <标签 />, 也被称为自闭合标签

# HTTP

http协议的步骤:

1. 建立TCP连接(三次握手)
2. 进行http通信(一次请求和一次响应配对)
3. 关闭TCP连接

http目前的主流版本是1.1

1.0和1.1的区别:

1.0一个连接只能进行一次http通信

1.1一个连接可以进行多次http通信(持久连接)

## 请求

**注意get请求的全部数据都编码在请求的url中, 并且遵循特殊的url编码规则, 在ASCII的基础上还额外支持各种语言和特殊符号**

请求方法(http method)有九种:GET POST PUT HEAD DELETE PATCH OPTIONS CONNECT TRACE

常用请求方式

| 请求方式 | 作用                                    |
| -------- | --------------------------------------- |
| GET      | 获取uri对应的资源                       |
| POST     | 向uri对应的接口提交数据, 交给服务器处理 |
| PUT      | 向uri对应的地址上传资源                 |
| DELETE   | 请求删除uri对应的资源                   |
| PATCH    | 对uri对应的资源进行修改                 |
| TRACE    | 用于调试                                |

面试题: GET和POST的区别

| GET                                                          | POST                             |
| ------------------------------------------------------------ | -------------------------------- |
| reload不影响服务器                                           | reload会导致数据被重复发送       |
| 可以被浏览器缓存                                             | 从不缓存                         |
| 用户在地址栏输入url会默认使用GET方法                         |                                  |
| 会保存到浏览器历史记录                                       | 不会被历史记录保存               |
| 有长度限制(因为get请求的数据是直接加到url上, url长度限制为2048) | 无长度限制                       |
| 用于请求数据返回                                             | 用于发送数据到服务器             |
| 请求内容是使用ASCII编码的字符                                | 可以发送二进制文件               |
| 明文使用url发送, 不安全                                      | 发送数据不会显示在url中,, 较安全 |

**面试**

PUT方法和POST方法相似, 但是put方法多次被调用时不会重复创建资源, 而post方法会重复创建资源

HEAD方法和GET方法类似, 但是head方法会导致服务器返回的响应中不包含body(主体) 因此head方法常用于get下载文件前检查请求是否增强

## 请求和响应的区别

http请求通常分为3部分: 

1. 请求行(request line):包含 请求方法 请求的URI http协议版本
2. 请求头:可以包含多个header
3. 请求体:正文(body可以省略)

http响应也分为3部分:

1. 状态行: 包括http协议版本, 状态码, 状态码描述信息
2. 响应头: 可以包含多个header
3. 响应体: (body可以省略)

**请求header**

每个header都由字段和值组成, 类似于键值对的结构

| 字段           | 作用                                    |
| -------------- | --------------------------------------- |
| Accept         | 浏览器支持的数据类型                    |
| Accept-Charset | 浏览器支持的编码                        |
| Host           | 用户想要访问的服务器                    |
| Referer        | 浏览器从哪个页面跳转过来                |
| User-Agent     | 用户的标识信息(浏览器版本 操作系统版本) |
| Cookie         | 一般缓存在浏览器中, 用于身份验证        |
| Cache-Control  | 浏览器的缓存控制机制                    |
| Connection     | 是否需要在请求完成后关闭连接            |

**响应header**

| 字段           | 作用                         |
| -------------- | ---------------------------- |
| Server         | 服务器信息(类型, 版本)       |
| Date           | 服务器响应时间               |
| Expire         | 缓存过期时间                 |
| Location       | 重定向的url地址              |
| Accept-Ranges  | 是否支持分段请求以及请求范围 |
| Cache-Control  | 缓存控制                     |
| Content-Length | 响应内容长度                 |
| Content-Type   | 响应内容类型                 |
| Set-Cookie     | 发送Cookie信息               |
| Connection     | 是否需要持久连接             |

其中的Content-Type使用MIME类型表示

| MIME类型                |
| ----------------------- |
| text/plain              |
| text/xml                |
| text/html               |
| text/css                |
| image/gif               |
| image/png               |
| application/javascript  |
| application/x-httpd-php |
| application/rtf         |
| application/pdf         |

浏览器遇到无法识别的MIME类型会默认执行下载操作

请求行

```bash
GET /index.html HTTP/1.1
#请求方法	请求的uri	HTTP版本
```

状态行

```BASH
HTTP/1.1 200 OK
#HTTP版本 状态码	状态描述信息
```

> 状态码和状态描述信息是配对的

状态码有五类:

| 分类 | 作用                     | 级别       |
| ---- | ------------------------ | ---------- |
| 1XX  | 需要客户端提交下一步请求 | 信息       |
| 2XX  | 成功处理请求             | 成功       |
| 3XX  | 重定向                   | 重定向     |
| 4XX  | 客户端的请求有问题       | 客户端问题 |
| 5XX  | 服务器或网关有问题       | 服务端问题 |

常见状态码

| 状态码 | 含义                       |
| ------ | -------------------------- |
| 200    | 请求处理成功               |
| 301    | 返回一个新的永久地址       |
| 302    | 返回一个新的临时地址       |
| 401    | 未授权                     |
| 403    | 请求被拒绝(一般是权限问题) |
| 404    | 请求的资源不存在           |
| 499    | 请求超时                   |
| 500    | 服务器内部错误             |
| 502    | 网关错误                   |
| 504    | 网关超时                   |

# URI和URL

URI: 统一资源标识符

URL: 统一资源位置(地址)

> 举例: 书籍的ISBN是URI但不是URL, ISBN标记了一本特定的书, 但是没有提供对应书籍的地址
>
> 图片网址是URL也是URI, 提供了一个图片的网络地址

URI使用特定的语法规则来标识一个特定资源

而URL是一种特殊的URI, 除了标识资源还提供了对应资源的网络地址

URI在java中抽象为java.net.URI类

URL在java中抽象为java.net.URL

>java.net.URL被final修饰

URL是一种特殊的URI

```bash
#URI语法
模式:模式内容
#示例URI
jdbc:mysql://127.0.0.1:3306/test?useSSL=false
#模式内容一般为层次结构
//接口地址/路径?参数=值&其他参数
```

URI的字符串中一般使用ASCII作为基础进行编码, 额外的字符需要使用16进制的UTF-8编码, 并且需要使用%作为转义字符

```bash
#"木"的16进制UTF-8编码
#注意下面每个0x后对应8位2进制
0xE6 0x9C 0xA8
#转义后的URI字符串
%E6%9C%A8
```

> 在java中有URLEncoder或apache-codec等库提供了URL(URI)编码功能

URL分为相对URL和绝对URL, 一个网站中的子链接可以继承父文档URL的部分信息

> 以/开头的相对URL代表其路径是相对于文档的根目录, 而不是继承当前文档的相对目录

